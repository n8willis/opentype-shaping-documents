
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Universal Shaping Engine script shaping in OpenType &#8212; OpenType Shaping Documents  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="universal-shaping-engine-script-shaping-in-opentype">
<h1>Universal Shaping Engine script shaping in OpenType<a class="headerlink" href="#universal-shaping-engine-script-shaping-in-opentype" title="Permalink to this heading">¶</a></h1>
<p>This document details the default shaping procedure needed to display
text runs in scripts supported by the Universal Shaping Engine (USE)
model.</p>
<p><strong>Table of Contents</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#general-information"><span class="std std-doc">General information</span></a></p></li>
<li><p><a class="reference internal" href="#terminology"><span class="std std-doc">Terminology</span></a></p></li>
<li><p><a class="reference internal" href="#glyph-classification"><span class="std std-doc">Glyph classification</span></a></p></li>
<li><p><a class="reference internal" href="#the-use-shaping-model"><span class="std std-doc">The USE shaping model</span></a></p>
<ul>
<li><p><a class="reference internal" href="#split-vowel-decomposition"><span class="std std-doc">1: Split vowel decomposition</span></a></p></li>
<li><p><a class="reference internal" href="#cluster-identification"><span class="std std-doc">2: Cluster identification</span></a></p></li>
<li><p><a class="reference internal" href="#basic-cluster-formation"><span class="std std-doc">3: Basic cluster formation</span></a></p>
<ul>
<li><p><a class="reference internal" href="#applying-the-basic-pre-processing-features-from-gsub"><span class="std std-doc">3.1: Applying the basic pre-processing features from GSUB</span></a></p></li>
<li><p><a class="reference internal" href="#applying-the-basic-reordering-features-from-gsub"><span class="std std-doc">3.2: Applying the basic reordering features from GSUB</span></a></p></li>
<li><p><a class="reference internal" href="#applying-the-basic-orthographic-features-from-gsub"><span class="std std-doc">3.3: Applying the basic orthographic features from GSUB</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#glyph-reordering"><span class="std std-doc">4: Glyph reordering</span></a></p>
<ul>
<li><p><a class="reference internal" href="#applying-the-reordering-features-from-gsub"><span class="std std-doc">4.1: Applying the reordering features from GSUB</span></a></p></li>
<li><p><a class="reference internal" href="#performing-property-based-reordering-moves"><span class="std std-doc">4.2: Performing property-based reordering moves</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#final-feature-application"><span class="std std-doc">5: Final feature application</span></a></p>
<ul>
<li><p><a class="reference internal" href="#applying-the-final-topographic-features-from-gsub"><span class="std std-doc">5.1: Applying the final topographic features from GSUB</span></a></p></li>
<li><p><a class="reference internal" href="#applying-the-final-typographic-presentation-features-from-gsub"><span class="std std-doc">5.2: Applying the final typographic-presentation features from GSUB</span></a></p></li>
<li><p><a class="reference internal" href="#applying-the-final-positioning-features-from-gpos"><span class="std std-doc">5.3: Applying the final positioning features from GPOS</span></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<section id="general-information">
<h2>General information<a class="headerlink" href="#general-information" title="Permalink to this heading">¶</a></h2>
<p>The Universal Shaping Engine (USE) model is used for complex scripts
that are not already supported by a dedicated OpenType shaping
model.</p>
<p>“Complex” scripts, in OpenType shaping terminology, are scripts that
require some combination of glyph reordering, contextual joining
behavior, or the substitution of context-dependent forms for
linguistic or orthographic correctness.</p>
<p>The scripts covered by this model include Javanese, Balinese,
Buginese, Batak, Chakma, Lepcha, Modi, Phags-pa, Tagalog, Siddham,
Sundanese, Tai Le, Tai Tham, Tai Viet, and many others.</p>
<p>In many ways, the USE model is a generalization of the
<a class="reference internal" href="opentype-shaping-indic-general.html"><span class="doc std std-doc">Indic2</span></a> OpenType
shaping model, with adjustments made to correct shortfalls encountered
when using the Indic2 shaping model, as well as additional changes
designed to broaden the number of scripts that can be supported. For
example, the USE model includes a step applying contextual
joining-behavior features as is performed in the Arabic-like shaping
model.</p>
<blockquote>
<div><p>Note: The term <em>Indic3</em> is sometimes used in comparison to Indic2
(or the corresponding increment of the script tags for existing
OpenType shaping models, such as <code class="docutils literal notranslate"><span class="pre">&lt;dev3&gt;</span></code> in comparison to
<code class="docutils literal notranslate"><span class="pre">&lt;dev2&gt;</span></code>).</p>
<p>This terminology either indicates that a shaping engine has
implemented support for one or more of the Indic2 scripts within the
USE model or it is merely a conversational convention to discuss
support for the Indic2-model scripts in USE.</p>
<p>At the present time, there is no formal definition for an Indic3
model, and there are not registered OpenType script tags for
<code class="docutils literal notranslate"><span class="pre">&lt;dev3&gt;</span></code> or any other third generation of the scripts handled by the
Indic2 model.</p>
</div></blockquote>
<p>USE was introduced after the release of version 8.0 of the Unicode
specification. The intent is for USE to support complex scripts added
to future Unicode releases in addition to those already supported.</p>
</section>
<section id="terminology">
<h2>Terminology<a class="headerlink" href="#terminology" title="Permalink to this heading">¶</a></h2>
<p>The USE shaping model uses a standard set of terms for the features of
supported scripts. These terms are similar to the standard terms used
for Indic scripts, but with several key distinctions.</p>
<p>A <strong>cluster</strong> is the fundamental unit used in shaping; it consists of
a sequence of Unicode codepoints that will be processed as an atomic
unit. An individual syllable typically corresponds to a single
cluster, but any particular cluster might involve multiple syllables
or a sequence that does not match the syllable-formation rules of the
script.</p>
<p>A <strong>base</strong> character in the USE model may be a consonant, an
independent vowel, a number, or any of several additional character
classes.</p>
<p>A cluster’s base consonant is generally rendered in its full form
(although it may form ligatures), while other consonants in the
cluster frequently take on secondary forms. Different GSUB
substitutions may apply to a script’s <strong>pre-base</strong> and <strong>post-base</strong>
consonants. Some of these substitutions create <strong>above-base</strong> or
<strong>below-base</strong> forms. The <strong>Reph</strong> form of the consonant “Ra” is an
example.</p>
<p>A <strong>vowel</strong> character in the USE model is a dependent vowel or any of
several additional marks with similar behavior. This class is similar
to the “matra” class used in Indic shaping.</p>
<p><strong>Halant</strong> is the standard term for a “vowel-killer” sign.</p>
</section>
<section id="glyph-classification">
<h2>Glyph classification<a class="headerlink" href="#glyph-classification" title="Permalink to this heading">¶</a></h2>
<p>The USE shaping model classifies characters based on a specific set of
properties defined for each codepoint in the Unicode Character
Database (UCD), augmented with a small set of pre-defined property
overrides.</p>
<p>The UCD properties used for USE character classification are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Unicode General Category (UGC)
Unicode Indic Syllabic Category (UISC)
Unicode Indic Positional Category (UIPC)
</pre></div>
</div>
<p>In addition, the Unicode Character Decomposition Mapping (UCDM) is used for
all split vowels.</p>
<section id="use-overrides">
<h3>USE overrides<a class="headerlink" href="#use-overrides" title="Permalink to this heading">¶</a></h3>
<p>Although, in general, the USE shaping model relies on the UGC, UISC,
and UIPC properties, the USE model makes a small set of standardized
overrides to the properties of certain specific characters.</p>
<p>The following table lists the complete set of USE overrides. Shaping
engines should implement the override properties in order to guarantee
correct results.</p>
<blockquote>
<div><p>Note: A <em>null</em> in the following table indicates that the
corresponding Unicode property is not overridden for the codepoint
featured in that row.</p>
</div></blockquote>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Codepoint</p></th>
<th class="head text-left"><p>Unicode UISC</p></th>
<th class="head text-left"><p>USE override UISC</p></th>
<th class="head text-left"><p>Unicode UIPC</p></th>
<th class="head text-left"><p>USE override UIPC</p></th>
<th class="head text-left"><p>Glyph</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+AA29</span></code></p></td>
<td class="text-left"><p>Vowel_Dependent</p></td>
<td class="text-left"><p>Bindu</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>ꨩ Cham Vowel Sign Aa</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0F71</span></code></p></td>
<td class="text-left"><p>Vowel_Dependent</p></td>
<td class="text-left"><p>Nukta</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>ཱ Tibetan Vowel Sign Aa</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+A982</span></code></p></td>
<td class="text-left"><p>Consonant_Succeeding_Repha</p></td>
<td class="text-left"><p>Tone_Mark</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>ꦂ Javanese Sign Layar</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0F7F</span></code></p></td>
<td class="text-left"><p>Visarga</p></td>
<td class="text-left"><p>Consonant_Dead</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>ཿ Tibetan Sign Rnam Bcad</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+11134</span></code></p></td>
<td class="text-left"><p>Pure_Killer</p></td>
<td class="text-left"><p>Gemination_Mark</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>𑄴 Chakma Maayyaa</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0F74</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>ུ Tibetan Vowel Sign U</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+AA35</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>ꨵ Cham Consonant Sign</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+1A18</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>ᨘ Buginese Vowel Sign U</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0F72</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>ི Tibetan Vowel Sign I</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0F7A</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>ེ Tibetan Vowel Sign E</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0F7B</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>ཻ Tibetan Vowel Sign Ee</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0F7C</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>ོ Tibetan Vowel Sign O</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0F7D</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>ཽ Tibetan Vowel Sign Oo</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0F80</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>ྀ Tibetan Vowel Sign Reversed Ii</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+11127</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>𑄧 Chakma Vowel Sign A</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+11128</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>𑄨 Chakma Vowel Sign I</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+11129</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>𑄩 Chakma Vowel Sign Ii</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+1112D</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>𑄭 Chakma Vowel Sign Ai</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+11130</span></code></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>Top</p></td>
<td class="text-left"><p>Bottom</p></td>
<td class="text-left"><p>𑄰 Chakma Vowel Sign Oi</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="use-classification-table">
<h3>USE classification table<a class="headerlink" href="#use-classification-table" title="Permalink to this heading">¶</a></h3>
<p>The following table lists the classes utilized in the USE shaping
model, along with a definition for each class. The class definitions
refer to the UGC, UISC, and UIPC categories in the Unicode standard,
or to specific Unicode codepoints.</p>
<p>The symbols given in the “Symbol” column for each class may be used to
express cluster-matching rules or other algorithms.</p>
<p>Vowels and modifiers may be further subclassified as described in the
<a class="reference internal" href="#use-subclasses-table"><span class="std std-doc">USE subclasses table</span></a> below.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>USE classification</p></th>
<th class="head text-left"><p>Symbol</p></th>
<th class="head text-left"><p>Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>BASE</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td class="text-left"><p>UISC = Number <em>or</em> (UISC = Avagraha &amp; UGC = Lo) <em>or</em> (UISC = Bindu &amp; UGC = Lo) <em>or</em> UISC = Consonant <em>or</em> (UISC = Consonant_Final &amp; UGC = Lo) <em>or</em> UISC = Consonant_Head_Letter <em>or</em> (UISC = Consonant_Medial &amp; UGC = Lo) <em>or</em> (UISC = Consonant_Subjoined &amp; UGC = Lo) <em>or</em> UISC = Tone_Letter <em>or</em> (UISC = Vowel &amp; UGC = Lo) <em>or</em> UISC = Vowel_Independent <em>or</em> (UISC = Vowel_Dependent &amp; UGC = Lo)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Combining grapheme joiner</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">CGJ</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+034F</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>CONS_MOD</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">CM</span></code></p></td>
<td class="text-left"><p>UISC = Nukta <em>or</em> Gemination_Mark <em>or</em> Consonant_Killer</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>CONS_WITH_STACKER</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">CS</span></code></p></td>
<td class="text-left"><p>UISC = Consonant_With_Stacker</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>CONS_FINAL</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">F</span></code></p></td>
<td class="text-left"><p>(UISC = Consonant_Final &amp; UGC != Lo) <em>or</em> UISC = Consonant_Succeeding_Repha</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>CONS_FINAL_MOD</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">FM</span></code></p></td>
<td class="text-left"><p>UISC = Syllable_Modifier</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>BASE_OTHER</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">GB</span></code></p></td>
<td class="text-left"><p>UISC = Consonant_Placeholder <em>or</em> <code class="docutils literal notranslate"><span class="pre">U+2015</span></code>, <code class="docutils literal notranslate"><span class="pre">U+2022</span></code>, <code class="docutils literal notranslate"><span class="pre">U+25FB</span></code>–<code class="docutils literal notranslate"><span class="pre">U+25FE</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>HALANT</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">H</span></code></p></td>
<td class="text-left"><p>UISC = Virama <em>or</em> Invisible_Stacker</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>HALANT_NUM</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">HN</span></code></p></td>
<td class="text-left"><p>UISC = Number_Joiner</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>BASE_IND</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">IND</span></code></p></td>
<td class="text-left"><p>(UISC = Consonant_Dead <em>or</em> Modifying_Letter) <em>or</em> (UGC = Po != <code class="docutils literal notranslate"><span class="pre">U+104E</span></code>, <code class="docutils literal notranslate"><span class="pre">U+2022</span></code>) <em>or</em> <code class="docutils literal notranslate"><span class="pre">U+002D</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>CONS_MED</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">M</span></code></p></td>
<td class="text-left"><p>UISC = Consonant_Medial &amp; UGC != Lo</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>BASE_NUM</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td class="text-left"><p>UISC = Brahmi_Joining_Number</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>OTHER</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">O</span></code></p></td>
<td class="text-left"><p>Any other SCRIPT_COMMON characters; White space characters, UGC=Zs</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>REPHA</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">R</span></code></p></td>
<td class="text-left"><p>UISC = Consonant_Preceding_Repha <em>or</em> Consonant_Prefixed</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Reserved character</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Rsv</span></code></p></td>
<td class="text-left"><p>Any character not currently assigned or otherwise reserved in Unicode</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>SYM</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td class="text-left"><p>UGC = Sc <em>or</em> (UGC = So &amp; != <code class="docutils literal notranslate"><span class="pre">U+25CC</span></code>)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>SYM_MOD</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">SM</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+1B6B</span></code>, <code class="docutils literal notranslate"><span class="pre">U+1B6C</span></code>, <code class="docutils literal notranslate"><span class="pre">U+1B6D</span></code>, <code class="docutils literal notranslate"><span class="pre">U+1B6E</span></code>, <code class="docutils literal notranslate"><span class="pre">U+1B6F</span></code>, <code class="docutils literal notranslate"><span class="pre">U+1B70</span></code>, <code class="docutils literal notranslate"><span class="pre">U+1B71</span></code>, <code class="docutils literal notranslate"><span class="pre">U+1B72</span></code>, <code class="docutils literal notranslate"><span class="pre">U+1B73</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>CONS_SUB</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">SUB</span></code></p></td>
<td class="text-left"><p>UISC = Consonant_Subjoined &amp; UGC != Lo</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>VOWEL</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">V</span></code></p></td>
<td class="text-left"><p>(UISC = Vowel &amp; UGC != Lo) <em>or</em> (UISC = Vowel_Dependent &amp; UGC != Lo) <em>or</em> UISC = Pure_Killer</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>VOWEL_MOD</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VM</span></code></p></td>
<td class="text-left"><p>(UISC = Bindu &amp; UGC != Lo) <em>or</em> UISC = Tone_Mark <em>or</em> Cantillation_Mark <em>or</em> Register_Shifter <em>or</em> Visarga</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>VARIATION_SELECTOR</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VS</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+FE00</span></code>‒<code class="docutils literal notranslate"><span class="pre">U+FE0F</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Word joiner</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">WJ</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+2060</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Zero width joiner</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">ZWJ</span></code></p></td>
<td class="text-left"><p>UISC = Joiner</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Zero width nonjoiner</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">ZWNJ</span></code></p></td>
<td class="text-left"><p>UISC = Non_Joiner</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="use-subclasses-table">
<h3>USE subclasses table<a class="headerlink" href="#use-subclasses-table" title="Permalink to this heading">¶</a></h3>
<p>Vowels and modifiers may be further subclassified based on their
position relative to base characters. The subclasses incorporated in
the USE shaping model are defined in the table below.</p>
<p>Split-vowel subclasses are not assigned a symbol because each split
vowel must be decomposed into its components.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>USE classification</p></th>
<th class="head text-left"><p>Symbol</p></th>
<th class="head text-left"><p>Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>CONS_MOD_ABOVE</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">CMAbv</span></code></p></td>
<td class="text-left"><p>USE=CM &amp; UIPC = Top</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>CONS_MOD_BELOW</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">CMBlw</span></code></p></td>
<td class="text-left"><p>USE=CM &amp; UIPC = Bottom</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>CONS_FINAL_ABOVE</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">FAbv</span></code></p></td>
<td class="text-left"><p>USE=F &amp; UIPC = Top</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>CONS_FINAL_BELOW</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">FBlw</span></code></p></td>
<td class="text-left"><p>USE=F &amp; UIPC = Bottom</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>CONS_FINAL_POST</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">FPst</span></code></p></td>
<td class="text-left"><p>USE=F &amp; UIPC = Right</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>CONS_MED_ABOVE</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">MAbv</span></code></p></td>
<td class="text-left"><p>USE=M &amp; UIPC = Top</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>CONS_MED_BELOW</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">MBlw</span></code></p></td>
<td class="text-left"><p>USE=M &amp; UIPC = Bottom</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>CONS_MED_PRE</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">MPre</span></code></p></td>
<td class="text-left"><p>USE=M &amp; UIPC = Left</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>CONS_MED_POST</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">MPst</span></code></p></td>
<td class="text-left"><p>USE=M &amp; UIPC = Right</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>SYM_MOD_ABOVE</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">SMAbv</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+1B6B</span></code>,<code class="docutils literal notranslate"><span class="pre">U+1B6D</span></code>,<code class="docutils literal notranslate"><span class="pre">U+1B6E</span></code>,<code class="docutils literal notranslate"><span class="pre">U+1B6F</span></code>,<code class="docutils literal notranslate"><span class="pre">U+1B70</span></code>,<code class="docutils literal notranslate"><span class="pre">U+1B71</span></code>,<code class="docutils literal notranslate"><span class="pre">U+1B72</span></code>,<code class="docutils literal notranslate"><span class="pre">U+1B73</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>SYM_MOD_BELOW</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">SMBlw</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+1B6C</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>VOWEL_ABOVE</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VAbv</span></code></p></td>
<td class="text-left"><p>USE=V &amp; UIPC = Top</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>VOWEL_ABOVE_BELOW</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>USE=V &amp; UIPC = Top_And_Bottom</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>VOWEL_ABOVE_BELOW_POST</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>USE=V &amp; UIPC = Top_And_Bottom_And_Right</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>VOWEL_ABOVE_POST</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>USE=V &amp; UIPC = Top_And_Right</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>VOWEL_BELOW</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VBlw</span></code></p></td>
<td class="text-left"><p>USE=V &amp; UIPC = Bottom <em>or</em> Overstruck</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>VOWEL_BELOW_POST</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>USE=V &amp; UIPC = Bottom_And_Right</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>VOWEL_PRE</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VPre</span></code></p></td>
<td class="text-left"><p>USE=V &amp; UIPC = Left</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>VOWEL_PRE_ABOVE</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>USE=V &amp; UIPC = Top_And_Left</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>VOWEL_PRE_ABOVE_POST</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>USE=V &amp; UIPC = Top_And_Left_And_Right</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>VOWEL_PRE_POST</p></td>
<td class="text-left"><p><em>null</em></p></td>
<td class="text-left"><p>USE=V &amp; UIPC = Left_And_Right</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>VOWEL_POST</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VPst</span></code></p></td>
<td class="text-left"><p>USE=V &amp; UIPC = Right</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>VOWEL_MOD_ABOVE</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VMAbv</span></code></p></td>
<td class="text-left"><p>USE=VM &amp; UIPC = Top</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>VOWEL_MOD_BELOW</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VMBlw</span></code></p></td>
<td class="text-left"><p>USE=VM &amp; UIPC = Bottom <em>or</em> Overstruck</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>VOWEL_MOD_PRE</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VMPre</span></code></p></td>
<td class="text-left"><p>USE=VM &amp; UIPC = Left</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>VOWEL_MOD_POST</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">VMPst</span></code></p></td>
<td class="text-left"><p>USE=VM &amp; UIPC = Right</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="the-use-shaping-model">
<h2>The USE shaping model<a class="headerlink" href="#the-use-shaping-model" title="Permalink to this heading">¶</a></h2>
<p>The USE shaping model consists of five top-level stages.</p>
<ol class="arabic simple">
<li><p>Decomposition of split vowels</p></li>
<li><p>Identifying clusters</p></li>
<li><p>Applying basic cluster formation features</p></li>
<li><p>Glyph reordering</p></li>
<li><p>Applying final features</p></li>
</ol>
<p>All scripts supported by the USE model will be processed in this same
pattern. However, not every script requires that actions be taken in
every operation.</p>
<p>The first two stages take place for the entire text run being
shaped. Subsequently, stages 3, 4, and 5 are each conducted in order on a
per-cluster basis, until every cluster in the run has been processed.</p>
<p>The substitution features from GSUB and the positioning features from
GPOS are applied to the text run in predefined features groups. Which
features are applied at each step in the process are described below.</p>
<section id="split-vowel-decomposition">
<h3>1: Split vowel decomposition<a class="headerlink" href="#split-vowel-decomposition" title="Permalink to this heading">¶</a></h3>
<p>Most split vowels have a canonical decomposition defined in the
Unicode specification. The USE shaping model requires that all such
split vowels be decomposed into their components before any further
processing is performed.</p>
<p>For these vowels, the canonical decomposition must be performed prior
to cluster identification. Because this decomposition is a
character-level operation, the shaping engine may choose to perform it
earlier, such as during an initial Unicode-normalization stage.</p>
<p>For any split vowels that do not have a canonical decomposition, the
active font should provide a decomposition via the <code class="docutils literal notranslate"><span class="pre">ccmp</span></code> substitution
feature in GSUB.</p>
<p>The cluster-identification rules detailed in stage two are based on
the canonical decompositions, and do not take non-canonical GSUB
decomposition into account.</p>
</section>
<section id="cluster-identification">
<h3>2. Cluster identification<a class="headerlink" href="#cluster-identification" title="Permalink to this heading">¶</a></h3>
<p>A cluster in the USE model is defined according to a generalized,
visual pattern that is common to all supported scripts. Consequently,
the cluster-identification expressions used do not enforce linguistic
or orthographic correctness.</p>
<p>An independent cluster will consist of a standalone codepoint that
does not require further shaping, optionally followed by a variation
selector. Independent clusters will match the expression:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span>(IND | O | Rsv | WJ) VS?
</pre></div>
</div>
<p>A standard cluster features a required base character and may include
many optional elements. Standard clusters will match the expression:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span>( R | CS )? ( B | GB ) VS? CMAbv* CMBlw* ( ((H B) | SUB) VS? CMAbv* CMBlw* )* MPre? MAbv? MBlw? MPst? VPre* VAbv* VBlw* VPst* VMPre* VMAbv* VMBlw* VMPst* FAbv* FBlw* FPst* FM?
</pre></div>
</div>
<p>A halant-terminated cluster occurs when any character other than a <code class="docutils literal notranslate"><span class="pre">B</span></code>
follows a <code class="docutils literal notranslate"><span class="pre">H</span></code>. Halant-terminated clusters will match the expression:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span>( R | CS )? (B | GB) VS? CMAbv* CMBlw* ( ((H B) | SUB) VS? CMAbv* CMBlw*)* H
</pre></div>
</div>
<p>A number-joiner–terminated cluster will match the expression:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span>N VS? (HN N VS?)* HN
</pre></div>
</div>
<p>A numeral cluster will match the expression:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span>N VS? (HN N VS?)*
</pre></div>
</div>
<p>A symbol cluster will match the expression:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span>(S | GB) VS? SMAbv* SMBlw*
</pre></div>
</div>
<blockquote>
<div><p>Note: Practically speaking, shaping engines are highly unlikely to
encounter more than a small number of sequential vowel or modifiers
in any real-world clusters. Thus, implementations may choose to
limit occurrences by limiting some of the above expressions to a
finite length, such as <code class="docutils literal notranslate"><span class="pre">VPre{0,4}</span></code> rather than <code class="docutils literal notranslate"><span class="pre">VPre*</span></code>.</p>
</div></blockquote>
<p>The expressions above use state-machine syntax from the Ragel
state-machine compiler. The operators represent:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span>a* = zero or more copies of a
b+ = one or more copies of b
c? = optional instance of c
d{n} = exactly n copies of d
d{,n} = zero to n copies of d
d{n,} = n or more copies of d
d{n,m} = n to m copies of d
!e = not e
^f = character-level not f
g.h = concatenation of g and h
i|j = i or j
( ) = grouping of expression elements
</pre></div>
</div>
<p>Sequences not matching any of the above expressions should be regarded
as broken. The shaping engine may make a best-effort attempt
to shape the broken sequence, but making guarantees about the
correctness or appearance of the final result is out of scope for this
document.</p>
<p>After the clusters have been identified, each of the subsequent
shaping stages occurs on a per-cluster basis.</p>
</section>
<section id="basic-cluster-formation">
<h3>3: Basic cluster formation<a class="headerlink" href="#basic-cluster-formation" title="Permalink to this heading">¶</a></h3>
<p>The basic cluster formation stage is used to apply fundamental
substitutions necessary for script and language correctness.</p>
<section id="applying-the-basic-pre-processing-features-from-gsub">
<h4>3.1: Applying the basic pre-processing features from GSUB<a class="headerlink" href="#applying-the-basic-pre-processing-features-from-gsub" title="Permalink to this heading">¶</a></h4>
<p>The basic pre-processing step applies mandatory substitution features
using the rules in the font’s GSUB table. In preparation for this
stage, glyph sequences should be tagged for possible application
of GSUB features.</p>
<p>The order in which these features are applied is not canonical; they
should be applied in the order in which they appear in the GSUB table
in the font.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>locl
ccmp
nukt
akhn
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">locl</span></code> feature replaces default glyphs with any language-specific
variants, based on examining the language setting of the text run.</p>
<blockquote>
<div><p>Note: Strictly speaking, the use of localized-form substitutions is
not part of the shaping process, but of the localization process,
and could take place at an earlier point while handling the text
run. However, shaping engines are expected to complete the
application of the <code class="docutils literal notranslate"><span class="pre">locl</span></code> feature before applying the subsequent
GSUB substitutions in the following steps.</p>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">ccmp</span></code> feature allows a font to substitute mark-and-base sequences
with a pre-composed glyph including the mark and the base, or to
substitute a single glyph into an equivalent decomposed sequence of
glyphs.</p>
<p>If present, these composition and decomposition substitutions must be
performed before applying any other GSUB lookups, because
those lookups may be written to match only the <code class="docutils literal notranslate"><span class="pre">ccmp</span></code>-substituted
glyphs.</p>
<blockquote>
<div><p>Note: The <code class="docutils literal notranslate"><span class="pre">ccmp</span></code> feature may perform decompositions of split vowels
that do not have a canonical decomposition defined in Unicode. Split
vowels that do have a canonical decomposition were decomposed in
stage one.</p>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">nukt</span></code> feature replaces “<em>Consonant</em>,Nukta” sequences with a
precomposed nukta-variant of the consonant glyph.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">akhn</span></code> feature replaces specific sequences with required
ligatures. These sequences can occur anywhere in a cluster.
Akhand characters have orthographic status equivalent to full
consonants in some languages, and fonts may have later substitution
rules designed to match them in subsequences. Therefore, this
feature must be applied before all other many-to-one substitutions.</p>
</section>
<section id="applying-the-basic-reordering-features-from-gsub">
<h4>3.2: Applying the basic reordering features from GSUB<a class="headerlink" href="#applying-the-basic-reordering-features-from-gsub" title="Permalink to this heading">¶</a></h4>
<p>The basic reordering step applies mandatory substitution features from
GSUB that affect reordering elements.</p>
<p>For these features, the glyph substitutions themselves are applied at this
step. However, the actual reordering of the glyphs does not take place
until stage 4, step 1.</p>
<p>The order in which these substitutions must be performed is fixed for
all USE scripts:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rphf
pref
</pre></div>
</div>
<section id="rphf">
<h5>3.2.1 <code class="docutils literal notranslate"><span class="pre">rphf</span></code><a class="headerlink" href="#rphf" title="Permalink to this heading">¶</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">rphf</span></code> feature replaces cluster-initial “Ra,Halant” sequences with
the “Reph” glyph.</p>
<blockquote>
<div><p>Note: although the glyph substitution is performed in this step, the
corresponding glyph reordering move is not performed until a later
stage.</p>
</div></blockquote>
</section>
<section id="pref">
<h5>3.2.2 <code class="docutils literal notranslate"><span class="pre">pref</span></code><a class="headerlink" href="#pref" title="Permalink to this heading">¶</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">pref</span></code> feature replaces pre-base-consonant glyphs with any special
forms.</p>
<blockquote>
<div><p>Note: although the glyph substitution is performed in this step, the
corresponding glyph reordering move is not performed until a later
stage.</p>
</div></blockquote>
</section>
</section>
<section id="applying-the-basic-orthographic-features-from-gsub">
<h4>3.3: Applying the basic orthographic features from GSUB<a class="headerlink" href="#applying-the-basic-orthographic-features-from-gsub" title="Permalink to this heading">¶</a></h4>
<p>The basic orthographic step applies substitution features using the
rules in the font’s GSUB table. In preparation for this stage, glyph
sequences should be tagged for possible application of GSUB features.</p>
<p>The order in which these features are applied is not canonical; they
should be applied in the order in which they appear in the GSUB table
in the font.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rkrf
abvf
blwf
half
pstf
vatu
cjct
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">rkrf</span></code> feature replaces “<em>Consonant</em>,Halant,Ra” sequences with the
“Rakaar”-ligature form of the consonant glyph.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">abvf</span></code> feature replaces above-base-consonant glyphs with any
special forms.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">blwf</span></code> feature replaces below-base-consonant glyphs with any
special forms.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">half</span></code> feature replaces “<em>Consonant</em>,Halant” sequences before the
base consonant with “half forms” of the consonant glyphs.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pstf</span></code> feature replaces post-base-consonant glyphs with any
special forms.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">vatu</span></code> feature replaces certain sequences with “Vattu variant”
forms.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cjct</span></code> feature replaces sequences of adjacent consonants with
conjunct ligatures. These sequences must match “<em>Consonant</em>,Halant,<em>Consonant</em>”.</p>
</section>
</section>
<section id="glyph-reordering">
<h3>4: Glyph reordering<a class="headerlink" href="#glyph-reordering" title="Permalink to this heading">¶</a></h3>
<p>The glyph-reordering stage moves dependent vowels, diacritics, and
other mark glyphs in relation to the base consonant. All reordering is
performed in this stage, which is broken into two distinct steps:</p>
<ol class="arabic simple">
<li><p>Applying the reordering features from GSUB</p></li>
<li><p>Performing property-based reordering moves</p></li>
</ol>
<section id="applying-the-reordering-features-from-gsub">
<h4>4.1 Applying the reordering features from GSUB<a class="headerlink" href="#applying-the-reordering-features-from-gsub" title="Permalink to this heading">¶</a></h4>
<p>In this step, the reordering moves corresponding to the
glyph-reordering features in GSUB are performed.</p>
<p>Any glyph substitutions that apply to characters involved in these
reordering moves were performed in stage 3, step 2. Therefore, this
step only requires moving glyphs to their final positions.</p>
<p>The order in which these substitutions must be performed is fixed for
all USE scripts:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rphf
pref
</pre></div>
</div>
<section id="id1">
<h5>4.1.1 <code class="docutils literal notranslate"><span class="pre">rphf</span></code><a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h5>
<p>In stage 3, step 2, the <code class="docutils literal notranslate"><span class="pre">rphf</span></code> feature replaced cluster-initial
“Ra,Halant” sequences with the “Reph” glyph. The “Reph” glyph is now
reordered to its final position. The algorithm to determine the final
position of the “Reph” glyph is:</p>
<ul class="simple">
<li><p>Move the “Reph” right one position at a time.</p>
<ul>
<li><p>If the character immediately following the new position is an
explicit “Halant”, stop.</p></li>
<li><p>If the character immediately before the new position is a full
base (<code class="docutils literal notranslate"><span class="pre">B</span></code>) character, stop.</p></li>
<li><p>If the end of the cluster is reached, stop.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id2">
<h5>4.1.2 <code class="docutils literal notranslate"><span class="pre">pref</span></code><a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h5>
<p>In stage 3, step 2, the <code class="docutils literal notranslate"><span class="pre">pref</span></code> feature replaced pre-base-consonant
glyphs with special forms. The pre-base-consonant glyph is now
reordered to its final position. The algorithm to determine the final
position of the pre-base-reordering consonant is:</p>
<ul class="simple">
<li><p>Move the pre-base-reordering consonant left one position at a
time.</p>
<ul>
<li><p>If the pre-base reordering consonant is to the left of the
first spacing glyph after an explicit “Halant”, stop.</p></li>
<li><p>When the pre-base reordering consonant is to the left of the
first spacing glyph in the cluster, stop.</p></li>
<li><p>If the beginning of the cluster is reached, stop.</p></li>
</ul>
</li>
</ul>
<blockquote>
<div><p>Note: Each cluster may have only one pre-base-reordering consonant
glyph.</p>
<p>Note: scripts that use pre-base medial consonants may also make use
of the <code class="docutils literal notranslate"><span class="pre">pref</span></code> feature reordering.</p>
</div></blockquote>
</section>
</section>
<section id="performing-property-based-reordering-moves">
<h4>4.2 Performing property-based reordering moves<a class="headerlink" href="#performing-property-based-reordering-moves" title="Permalink to this heading">¶</a></h4>
<p>In this step, any characters that match one of the USE reordering
classifications should be reordered into their final position.</p>
<blockquote>
<div><p>Note: this classification-based reordering step ensures that
reordering characters not addressed by the active font’s GSUB
features are ordered correctly.</p>
</div></blockquote>
<p>The character classes reordered in this step are:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span><span class="sb">`R`</span>		= <span class="sb">`REPHA`</span>
<span class="sb">`VPre`</span>		= <span class="sb">`VOWEL_PRE`</span>
<span class="sb">`VMPre`</span>		= <span class="sb">`VOWEL_MOD_PRE`</span>
</pre></div>
</div>
<p>Pre-base <code class="docutils literal notranslate"><span class="pre">REPHA</span></code> glyphs that occur before a full base are reordered
using the “Reph” reordering algorithm described in step <a class="reference internal" href="#id1"><span class="std std-doc">4.1.1</span></a>, just as if
the <code class="docutils literal notranslate"><span class="pre">rphf</span></code> feature had been applied to the glyph.</p>
<p>Pre-base <code class="docutils literal notranslate"><span class="pre">VOWEL_PRE</span></code> vowel glyphs, including both stand-alone <code class="docutils literal notranslate"><span class="pre">VOWEL_PRE</span></code> vowels
and <code class="docutils literal notranslate"><span class="pre">VOWEL_PRE</span></code> components of split vowels, are reordered to</p>
<ul class="simple">
<li><p>before the base glyph</p></li>
<li><p>before any other pre-base glyphs that were reordered in earlier steps</p></li>
</ul>
<p>Pre-base <code class="docutils literal notranslate"><span class="pre">VOWEL_MOD_PRE</span></code> vowel-modifier glyphs are reordered to</p>
<ul class="simple">
<li><p>before the base glyph</p></li>
<li><p>before any pre-base <code class="docutils literal notranslate"><span class="pre">VOWEL_PRE</span></code> vowel glyphs</p></li>
<li><p>before any other pre-base glyphs that were reordered in earlier steps</p></li>
</ul>
</section>
</section>
<section id="final-feature-application">
<h3>5: Final feature application<a class="headerlink" href="#final-feature-application" title="Permalink to this heading">¶</a></h3>
<p>The final stage involves applying topographic joining features for
connected scripts, applying typographic-presentation features from
GSUB, and applying positioning features from GPOS.</p>
<section id="applying-the-final-topographic-features-from-gsub">
<h4>5.1: Applying the final topographic features from GSUB<a class="headerlink" href="#applying-the-final-topographic-features-from-gsub" title="Permalink to this heading">¶</a></h4>
<p>For connected scripts, this step applies the substitutions to select
the correct topographic form for each glyph, based on its position in
the syllable.</p>
<p>Whether or not each codepoint joins on the left or the right side is
determined by the <code class="docutils literal notranslate"><span class="pre">Unicode</span> <span class="pre">Joining</span> <span class="pre">Type</span></code> (UJT) property defined in UCD
for each codepoint.</p>
<blockquote>
<div><p>Note: USE does not support positional typographic features for any
non-connected scripts.</p>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>isol
init
medi
fina
</pre></div>
</div>
</section>
<section id="applying-the-final-typographic-presentation-features-from-gsub">
<h4>5.2: Applying the final typographic-presentation features from GSUB<a class="headerlink" href="#applying-the-final-typographic-presentation-features-from-gsub" title="Permalink to this heading">¶</a></h4>
<p>The final typographic-presentation step applies mandatory substitution
features using the rules in the font’s GSUB table. In preparation for this
stage, glyph sequences should be tagged for possible application
of GSUB features.</p>
<p>The order in which these features are applied is not canonical; they
should be applied in the order in which they appear in the GSUB table
in the font.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>abvs
blws
calt
clig
haln
liga
pres
psts
rclt
rlig
vert
vrt2
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">abvs</span></code> feature replaces above-base-consonant glyphs with special
presentation forms. This usually includes contextual variants of
above-base marks or contextually appropriate mark-and-base ligatures.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">blws</span></code> feature replaces below-base-consonant glyphs with special
presentation forms. This usually includes replacing consonants that
are adjacent to special consonant forms with contextual
ligatures.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">calt</span></code> feature substitutes glyphs with contextual alternate
forms.  In contrast to <code class="docutils literal notranslate"><span class="pre">rclt</span></code>, the <code class="docutils literal notranslate"><span class="pre">calt</span></code> feature performs
substitutions that are not mandatory for orthographic
correctness. However, unlike <code class="docutils literal notranslate"><span class="pre">rclt</span></code>, the substitutions made by <code class="docutils literal notranslate"><span class="pre">calt</span></code>
can be disabled by application-level user interfaces.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">clig</span></code> feature substitutes optional ligatures that are on by
default, but which are activated only in certain
contexts. Substitutions made by clig may be disabled by
application-level user interfaces.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">haln</span></code> feature replaces syllable-final “<em>Consonant</em>,Halant” pairs with
special presentation forms. This can include stylistic variants of the
consonant where placing the “Halant” mark on its own is
typographically problematic.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">liga</span></code> feature substitutes standard, optional ligatures that are on
by default. Substitutions made by <code class="docutils literal notranslate"><span class="pre">liga</span></code> may be disabled by
application-level user interfaces.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pres</span></code> feature replaces pre-base-consonant glyphs with special
presentations forms. This can include consonant conjuncts, half-form
consonants, and stylistic variants of left-side dependent vowels
(matras).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">psts</span></code> feature replaces post-base-consonant glyphs with special
presentation forms. This usually includes replacing right-side
dependent vowels (matras) with stylistic variants or replacing
post-base-consonant/matra pairs with contextual ligatures.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rclt</span></code> feature substitutes glyphs with contextual alternate
forms. The <code class="docutils literal notranslate"><span class="pre">rclt</span></code> feature should be used to perform such substitutions
that are required by the orthography of the active script and
language. Substitutions made by <code class="docutils literal notranslate"><span class="pre">rclt</span></code> cannot be disabled by
application-level user interfaces.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rlig</span></code> feature substitutes glyph sequences with mandatory
ligatures. Substitutions made by <code class="docutils literal notranslate"><span class="pre">rlig</span></code> cannot be disabled by
application-level user interfaces.</p>
</section>
<section id="applying-the-final-positioning-features-from-gpos">
<h4>5.3: Applying the final positioning features from GPOS<a class="headerlink" href="#applying-the-final-positioning-features-from-gpos" title="Permalink to this heading">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>curs
dist
kern
mark
abvm
blwm
mkmk
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">curs</span></code> feature perform cursive positioning in connected scripts or
cursive styles. Each cursive glyph has an entry point and exit point;
the <code class="docutils literal notranslate"><span class="pre">curs</span></code> feature positions glyphs so that the entry point of the
current glyph meets the exit point of the preceding glyph.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dist</span></code> feature adjusts the horizontal positioning of
glyphs. Unlike <code class="docutils literal notranslate"><span class="pre">kern</span></code>, adjustments made with <code class="docutils literal notranslate"><span class="pre">dist</span></code> do not require the
application or the user to enable any software <em>kerning</em> features, if
such features are optional.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">kern</span></code> adjusts glyph spacing between pairs of adjacent glyphs.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">mark</span></code> feature positions marks with respect to base glyphs.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">abvm</span></code> feature positions above-base marks for attachment to base
characters. This includes above-base dependent vowels (matras),
diacritical marks, syllable modifiers, and above-base consonant forms.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">blwm</span></code> feature positions below-base marks for attachment to base
characters. This includes below-base dependent vowels (matras),
diacritical marks, syllable modifiers, and below-base consonant forms.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">mkmk</span></code> feature positions marks with respect to preceding marks,
providing proper positioning for sequences of marks that attach to the
same base glyph.</p>
</section>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">OpenType Shaping Documents</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=n8willis&repo=opentype-shaping-documents&type=watch&count=True&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="README.html">Scripts</a></li>
    
    <li class="toctree-l1"><a href="character-tables/character-tables-index.html">Character tables</a></li>
    
    <li class="toctree-l1"><a href="opentype-shaping-normalization.html">Normalization</a></li>
    
    <li class="toctree-l1"><a href="notes/README.html">Notes</a></li>
    
    <li class="toctree-l1"><a href="errata.html">Errata</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Sponsored by YesLogic.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/opentype-shaping-use.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>