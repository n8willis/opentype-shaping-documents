
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Arabic-style shaping in OpenType &#8212; OpenType Shaping Documents  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="arabic-style-shaping-in-opentype">
<h1>Arabic-style shaping in OpenType<a class="headerlink" href="#arabic-style-shaping-in-opentype" title="Permalink to this heading">¶</a></h1>
<p>This document details the general shaping procedure shared by Arabic, N’Ko,
Syriac, and Mongolian.</p>
<p><strong>Table of Contents</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#general-information"><span class="std std-doc">General information</span></a></p></li>
<li><p><a class="reference internal" href="#terminology"><span class="std std-doc">Terminology</span></a></p></li>
<li><p><a class="reference internal" href="#glyph-classification"><span class="std std-doc">Glyph classification</span></a></p>
<ul>
<li><p><a class="reference internal" href="#joining-properties"><span class="std std-doc">Joining properties</span></a></p></li>
<li><p><a class="reference internal" href="#mark-classification"><span class="std std-doc">Mark classification</span></a></p></li>
<li><p><a class="reference internal" href="#character-tables"><span class="std std-doc">Character tables</span></a></p></li>
</ul>
</li>
<li><p><span class="xref myst">The <code class="docutils literal notranslate"><span class="pre">&lt;arab&gt;</span></code> shaping model</span></p>
<ul>
<li><p><a class="reference internal" href="#transient-reordering-of-modifier-combining-marks"><span class="std std-doc">1. Transient reordering of modifier combining marks</span></a></p></li>
<li><p><a class="reference internal" href="#compound-character-composition-and-decomposition"><span class="std std-doc">2. Compound character composition and decomposition</span></a></p></li>
<li><p><a class="reference internal" href="#computing-letter-joining-states"><span class="std std-doc">3. Computing letter joining states</span></a></p></li>
<li><p><a class="reference internal" href="#applying-the-stch-feature"><span class="std std-doc">4. Applying the <code class="docutils literal notranslate"><span class="pre">stch</span></code> feature</span></a></p></li>
<li><p><a class="reference internal" href="#applying-the-language-form-substitution-features-from-gsub"><span class="std std-doc">5. Applying the language-form substitution features from GSUB</span></a></p></li>
<li><p><a class="reference internal" href="#applying-the-typographic-form-substitution-features-from-gsub"><span class="std std-doc">6. Applying the typographic-form substitution features from GSUB</span></a></p></li>
<li><p><a class="reference internal" href="#applying-the-positioning-features-from-gpos"><span class="std std-doc">7. Applying the positioning features from GPOS</span></a></p></li>
</ul>
</li>
</ul>
<section id="general-information">
<h2>General information<a class="headerlink" href="#general-information" title="Permalink to this heading">¶</a></h2>
<p>Several scripts can be supported by the general OpenType shaping model
used for Arabic. These writing systems observe similar rules and
conventions, even if they are not historically related to
Arabic. Therefore, OpenType defines many of the same GSUB and GPOS
features as supported for the corresponding script tags. These scripts include:</p>
<ul class="simple">
<li><p><a class="reference internal" href="opentype-shaping-arabic.html"><span class="doc std std-doc">Arabic</span></a></p></li>
<li><p><a class="reference internal" href="opentype-shaping-nko.html"><span class="doc std std-doc">N’Ko</span></a></p></li>
<li><p><a class="reference internal" href="opentype-shaping-syriac.html"><span class="doc std std-doc">Syriac</span></a></p></li>
<li><p><a class="reference internal" href="opentype-shaping-mongolian.html"><span class="doc std std-doc">Mongolian</span></a></p></li>
</ul>
<p>The information found below is intended to serve as a general guide;
script-specific information can be found in the linked document for
each script.</p>
<p>Each of these writing systems uses a joining script that uses
inter-word spaces. Therefore, each codepoint in a text run may be
substituted with one of several contextual forms corresponding to
what, if any, characters appear before and after the codepoint. Most,
but not all, letter sequences join; shaping engines must track which
positions trigger joining behavior for each letter.</p>
<p>Arabic, N’Ko, and Syriac are written (and, therefore, rendered) from right to
left. Mongolian is written vertically, from top to bottom. Shaping
engines must track the directionality of the text run when scripts of
different direction are mixed.</p>
</section>
<section id="terminology">
<h2>Terminology<a class="headerlink" href="#terminology" title="Permalink to this heading">¶</a></h2>
<p>OpenType shaping uses a standard set of terms for elements of the
supported scripts. The terms used colloquially in any particular language
may vary, however, potentially causing confusion.</p>
<p><strong>Base</strong> glyph or character is the standard term for a
character that is capable of taking a diacritical mark.</p>
<p><strong>Kashida</strong> (or <strong>tatweel</strong>) is the term for a glyph inserted into a
sequence for the purpose of elongating the baseline stroke of a
letter. Unicode documents use the term “tatweel” most frequently,
while OpenType documents use the term “kashida” most
frequently. Kashidas are typically inserted in order to justify lines
of text.</p>
</section>
<section id="glyph-classification">
<h2>Glyph classification<a class="headerlink" href="#glyph-classification" title="Permalink to this heading">¶</a></h2>
<p>In joining (or cursive) scripts, proper shaping of
text runs involves identifying the joining behavior of each character,
then combining that information with any preceding or subsequent
characters to determine the contextually correct form for display.</p>
<section id="joining-properties">
<h3>Joining properties<a class="headerlink" href="#joining-properties" title="Permalink to this heading">¶</a></h3>
<p>Characters are assigned a <code class="docutils literal notranslate"><span class="pre">JOINING_TYPE</span></code> property in the
Unicode standard that indicates how they join to adjacent
characters. There are six possible values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">JOINING_TYPE_LEFT</span></code> indicates that a character joins with
the subsequent character, but does not join with the preceding
character.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JOINING_TYPE_RIGHT</span></code> indicates that a character joins with the
preceding character, but does not join with the subsequent character.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JOINING_TYPE_DUAL</span></code> indicates that a character joins with the
preceding character and joins with the subsequent character.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JOINING_TYPE_NON_JOINING</span></code> indicates that a character does not
join with the preceding or with the subsequent character.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JOINING_TYPE_TRANSPARENT</span></code> indicates that the character does not
join with adjacent characters <em>and</em> that the character must be
skipped over when the shaping engine is evaluating the joining
positions in a sequence of characters. When a
<code class="docutils literal notranslate"><span class="pre">JOINING_TYPE_TRANSPARENT</span></code> character is encountered in a sequence,
the <code class="docutils literal notranslate"><span class="pre">JOINING_TYPE</span></code> of the preceding character passes
through. Diacritical marks are frequently assigned this value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JOINING_TYPE_JOIN_CAUSING</span></code> indicates that the character forces
the use of joining forms with the preceding and subsequent
characters. Kashidas and the Zero Width Joiner (<code class="docutils literal notranslate"><span class="pre">U+200D</span></code>) are both
<code class="docutils literal notranslate"><span class="pre">JOIN_CAUSING</span></code> characters.</p></li>
</ul>
<p>In some scripts (such as Arabic and Syriac), letters are also assigned
to a <code class="docutils literal notranslate"><span class="pre">JOINING_GROUP</span></code> that indicates which fundamental character they
behave like with regard to joining behavior. Each of the basic letters
in the script typically belongs to its own <code class="docutils literal notranslate"><span class="pre">JOINING_GROUP</span></code>, while
supplemental and accented letters are usually assigned to the
<code class="docutils literal notranslate"><span class="pre">JOINING_GROUP</span></code> that corresponds to the underlying base letter, with
no diacritics or other marks.</p>
<p>For example, the Persian letter “Peh” (<code class="docutils literal notranslate"><span class="pre">U+067E</span></code>) is visually
represented as the Arabic letter “Beh” (<code class="docutils literal notranslate"><span class="pre">U+0628</span></code>), but with two additional
below-base “ijam” marks. Consequently, “Peh” is assigned to the <code class="docutils literal notranslate"><span class="pre">BEH</span></code>
<code class="docutils literal notranslate"><span class="pre">JOINING_GROUP</span></code>.</p>
<p>Mongolian and N’Ko, notably, do not make use of joining groups. Every
letter in these scripts belongs to the <em>null</em> or <code class="docutils literal notranslate"><span class="pre">NO_JOINING_GROUP</span></code>
group.</p>
</section>
<section id="mark-classification">
<h3>Mark classification<a class="headerlink" href="#mark-classification" title="Permalink to this heading">¶</a></h3>
<p>The Unicode standard defines a <em>canonical combining class</em> for each
codepoint that is used whenever a sequence needs to be sorted into
canonical order.</p>
<p>The marks in most scripts belong to the standard combining
classes. For example:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Codepoint</p></th>
<th class="head text-left"><p>Combining class</p></th>
<th class="head text-left"><p>Glyph</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+064B</span></code></p></td>
<td class="text-left"><p>27</p></td>
<td class="text-left"><p>ً Fathatan / Open fathatan</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+064C</span></code></p></td>
<td class="text-left"><p>28</p></td>
<td class="text-left"><p>ٌ Dammatan / Open dammatan</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+064D</span></code></p></td>
<td class="text-left"><p>29</p></td>
<td class="text-left"><p>ٍ Kasratan / Open Kasratan</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+064E</span></code></p></td>
<td class="text-left"><p>30</p></td>
<td class="text-left"><p>َ Fatha / Small fatha</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+064F</span></code></p></td>
<td class="text-left"><p>31</p></td>
<td class="text-left"><p>ُ Damma / Small damma</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0650</span></code></p></td>
<td class="text-left"><p>32</p></td>
<td class="text-left"><p>ِ Kasra / Small kasra</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0651</span></code></p></td>
<td class="text-left"><p>33</p></td>
<td class="text-left"><p>ّ Shadda</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0652</span></code></p></td>
<td class="text-left"><p>34</p></td>
<td class="text-left"><p>ْ Sukun</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">U+0670</span></code></p></td>
<td class="text-left"><p>35</p></td>
<td class="text-left"><p>ٰ Superscript Alef</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p>220</p></td>
<td class="text-left"><p>Other below-base combining marks</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p>230</p></td>
<td class="text-left"><p>Other above-base combining marks</p></td>
</tr>
</tbody>
</table>
<p>The numeric values of these combining classes are used during Unicode
normalization. Sequences of marks are sorted by combining class,
reordering the sequence into increasing numerical order.</p>
<p>In addition, some Arabic and Syriac marks require special handling
when shaping Arabic text, during the mark-reordering stage. These
marks fall into two classes of <em>Modifier Combining Marks</em> (MCM) that
may need to be repositioned closer to the base character, when they
occur in sequences of multiple marks.</p>
<p>The sets are:</p>
<ul class="simple">
<li><p>Below-base (class 220) MCMs</p></li>
<li><p>Above-base (class 230) MCMs</p></li>
</ul>
<p>These classifications are used in the <a class="reference internal" href="#transient-reordering-of-modifier-combining-marks"><span class="std std-doc">mark-transient-reordering
stage</span></a>.</p>
<p>Lists of the marks that belong to each MCM classes are included in the
script-specific shaping documents for Arabic and Syriac.</p>
</section>
<section id="character-tables">
<h3>Character tables<a class="headerlink" href="#character-tables" title="Permalink to this heading">¶</a></h3>
<p>Character tables for all of the scripts, plus important miscellaneous
characters, are available here:</p>
<ul class="simple">
<li><p><a class="reference internal" href="character-tables/character-tables-arabic.html#arabic-character-table"><span class="std std-doc">Arabic</span></a></p></li>
<li><p><a class="reference internal" href="character-tables/character-tables-syriac.html#syriac-character-table"><span class="std std-doc">Syriac</span></a></p></li>
<li><p><a class="reference internal" href="character-tables/character-tables-nko.html#nko-character-table"><span class="std std-doc">N’Ko</span></a></p></li>
<li><p><a class="reference internal" href="character-tables/character-tables-mongolian.html#mongolian-character-table"><span class="std std-doc">Mongolian</span></a></p></li>
</ul>
</section>
</section>
<section id="the-general-arabic-based-shaping-model">
<h2>The general Arabic-based shaping model<a class="headerlink" href="#the-general-arabic-based-shaping-model" title="Permalink to this heading">¶</a></h2>
<p>Processing a run of text tagged with any of the scripts supported by
the general Arabic shaping model involves seven top-level stages:</p>
<ol class="arabic simple">
<li><p>Transient reordering of modifier combining marks</p></li>
<li><p>Compound character composition and decomposition</p></li>
<li><p>Computing letter joining states</p></li>
<li><p>Applying the <code class="docutils literal notranslate"><span class="pre">stch</span></code> feature</p></li>
<li><p>Applying the language-form substitution features from GSUB</p></li>
<li><p>Applying the typographic-form substitution features from GSUB</p></li>
<li><p>Applying the positioning features from GPOS</p></li>
</ol>
<section id="transient-reordering-of-modifier-combining-marks">
<h3>1. Transient reordering of modifier combining marks<a class="headerlink" href="#transient-reordering-of-modifier-combining-marks" title="Permalink to this heading">¶</a></h3>
<!--- http://www.unicode.org/reports/tr53/tr53-1.pdf --->
<blockquote>
<div><p>Note: the transient reordering of modifier combining marks is
necessary only for scripts that can feature the “Shadda” mark or
marks that belong to <em>Modifier Combining Marks</em> (MCM) classes.</p>
</div></blockquote>
<p>Sequences of adjacent marks must be reordered so that they appear in
the appropriate visual order before the mark-to-base and mark-to-mark
positioning features from GPOS can be correctly applied.</p>
<p>In particular, those marks that have strong affinity to the base
character must be placed closest to the base.</p>
<p>This mark-reordering operation is distinct from the standard,
cross-script mark-reordering performed during Unicode
normalization. The standard Unicode mark-reordering algorithm is based
on comparing the <em>Canonical_Combining_Class</em> (Ccc) properties of mark
codepoints, whereas this script-specific reordering utilizes the
<em>Modifier_Combining_Mark</em> (<code class="docutils literal notranslate"><span class="pre">MCM</span></code>) subclasses specified in the
character tables.</p>
<p>The algorithm for reordering a sequence of marks is:</p>
<ul class="simple">
<li><p>First, move any “Shadda” (combining class <code class="docutils literal notranslate"><span class="pre">33</span></code>) characters to the
beginning of the mark sequence.</p></li>
<li><p>Second, move any subsequence of combining-class-<code class="docutils literal notranslate"><span class="pre">230</span></code> characters that begins
with a <code class="docutils literal notranslate"><span class="pre">230_MCM</span></code> character to the beginning of the sequence,
before all “Shadda” characters. The subsequence must be moved
as a group.</p></li>
<li><p>Finally, move any subsequence of combining-class-<code class="docutils literal notranslate"><span class="pre">220</span></code> characters that begins
with a <code class="docutils literal notranslate"><span class="pre">220_MCM</span></code> character to the beginning of the sequence,
before all “Shadda” characters and before all class-<code class="docutils literal notranslate"><span class="pre">230</span></code>
characters. The subsequence must be moved as a group.</p></li>
</ul>
<blockquote>
<div><p>Note: Unicode describes this mark-reordering operation, the Arabic
Mark Transient Reordering Algorithm (AMTRA), in Technical Report 53,
which describes it in terms that are distinct from standard,
Ccc-based mark reordering.</p>
<p>Specifically, AMTRA is designated as an operation performed during
text rendering only, which therefore does not impact other
Unicode-compliance issues such as allowable input sequences or text
encoding.</p>
<p>However, shaping engines may choose to perform the reordering of
modifier combining marks in conjunction with their Unicode
normalization functionality for increased efficiency.</p>
</div></blockquote>
</section>
<section id="compound-character-composition-and-decomposition">
<h3>2. Compound character composition and decomposition<a class="headerlink" href="#compound-character-composition-and-decomposition" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ccmp</span></code> feature allows a font to substitute</p>
<ul class="simple">
<li><p>mark-and-base sequences with a pre-composed glyph including both
the mark and the base (as is done in with a ligature substitution)</p></li>
<li><p>individual compound glyphs with the equivalent sequence of
decomposed glyphs (such as decomposing a letter with ijam into a
separate fundamental-letter glyph followed by an ijam-only glyph,
to permit more precise positioning)</p></li>
</ul>
<p>If present, these composition and decomposition substitutions must be
performed before applying any other GSUB or GPOS lookups, because
those lookups may be written to match only the <code class="docutils literal notranslate"><span class="pre">ccmp</span></code>-substituted
glyphs.</p>
</section>
<section id="computing-letter-joining-states">
<h3>3. Computing letter joining states<a class="headerlink" href="#computing-letter-joining-states" title="Permalink to this heading">¶</a></h3>
<p>In order to correctly apply the initial, medial, and final form
substitutions from GSUB during stage 6, the shaping engine must
tag every letter for possible application of the appropriate feature.</p>
<blockquote>
<div><p>Note: not all of the rules detailed below apply to every script that
is supported by the general Arabic shaping model.</p>
</div></blockquote>
<p>To determine which feature is appropriate, the shaping engine must
examine each word in turn and compute each letter’s joining state from
the letter’s <code class="docutils literal notranslate"><span class="pre">JOINING_TYPE</span></code> and the <code class="docutils literal notranslate"><span class="pre">JOINING_TYPE</span></code> of the
preceding character (if any).</p>
<blockquote>
<div><p>Note: Although the supported scripts use inter-word spaces, the
<code class="docutils literal notranslate"><span class="pre">init</span></code> feature does <em>not</em> refer to word-initial letters only and the
<code class="docutils literal notranslate"><span class="pre">fina</span></code> feature does <em>not</em> refer to word-final letters only.</p>
<p>Rather, both of these terms are defined with respect to whether or
not the preceding and subsequent letters form joins with the current
letter. The letters at word boundaries will, naturally, take on
initial and final forms, but initial and final forms of letters also
occur regularly within words, when the letter in question is
adjacent to a letter that does not form joins.</p>
</div></blockquote>
<p>This computation starts from the first letter of the word, temporarily
tagging the letter for <code class="docutils literal notranslate"><span class="pre">isol</span></code> substitution. If the first
letter is the only letter in the word, the <code class="docutils literal notranslate"><span class="pre">isol</span></code> tag will remain unchanged.</p>
<p>From here, the algorithm consumes each character in the string, one at
a time, keeping track of the JOINING_TYPE of the previous character.</p>
<p>If the current character is JOINING_TYPE_TRANSPARENT, move on to the next
character but preserve the currently-tracked JOINING_TYPE at its previous state.</p>
<p>If the preceding character’s JOINING_TYPE is LEFT, DUAL, or
JOIN_CAUSING:</p>
<ul class="simple">
<li><p>In <code class="docutils literal notranslate"><span class="pre">&lt;syrc&gt;</span></code> text, if the current character is “Alaph”, tag the
current character for <code class="docutils literal notranslate"><span class="pre">med2</span></code>, then update the tag for the
preceding character:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">isol</span></code> becomes <code class="docutils literal notranslate"><span class="pre">init</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fina</span></code> becomes <code class="docutils literal notranslate"><span class="pre">medi</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init</span></code> remains <code class="docutils literal notranslate"><span class="pre">init</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">medi</span></code> remains <code class="docutils literal notranslate"><span class="pre">medi</span></code></p></li>
</ul>
</li>
<li><p>If the current character’s JOINING_TYPE is RIGHT, DUAL, or
JOIN_CAUSING, tag the current character for <code class="docutils literal notranslate"><span class="pre">fina</span></code>, then update
the tag for the preceding character:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">isol</span></code> becomes <code class="docutils literal notranslate"><span class="pre">init</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fina</span></code> becomes <code class="docutils literal notranslate"><span class="pre">medi</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init</span></code> remains <code class="docutils literal notranslate"><span class="pre">init</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">medi</span></code> remains <code class="docutils literal notranslate"><span class="pre">medi</span></code></p></li>
</ul>
</li>
</ul>
<p>Otherwise, tag the current character for <code class="docutils literal notranslate"><span class="pre">isol</span></code>.</p>
<p>After testing the final character of the word, if the text is in <code class="docutils literal notranslate"><span class="pre">&lt;syrc&gt;</span></code> and
if the last character that is not JOINING_TYPE_TRANSPARENT or
JOINING_TYPE_NON_JOINING is “Alaph”, perform an additional test:</p>
<ul class="simple">
<li><p>If the preceding character is JOINING_TYPE_LEFT, tag the current character
for <code class="docutils literal notranslate"><span class="pre">fina</span></code></p></li>
<li><p>If the preceding character’s JOINING_GROUP is DALATH_RISH, tag the current
character for <code class="docutils literal notranslate"><span class="pre">fin3</span></code></p></li>
<li><p>Otherwise, tag the current character for <code class="docutils literal notranslate"><span class="pre">fin2</span></code></p></li>
</ul>
<p>Once the last character of the word has been processed, proceed to the
next word and repeat the algorithm, starting at the beginning of the
next word.</p>
<blockquote>
<div><p>Note: Because the processing of the characters in the algorithm
described above is deterministic, shaping engines may choose to
implement the joining-state computation as a state machine, in a lookup
table, or by any other means desirable.</p>
</div></blockquote>
<p>At the end of this process, all letters should be tagged for possible
substitution by one of the <code class="docutils literal notranslate"><span class="pre">isol</span></code>, <code class="docutils literal notranslate"><span class="pre">init</span></code>, <code class="docutils literal notranslate"><span class="pre">medi</span></code>, <code class="docutils literal notranslate"><span class="pre">med2</span></code>, <code class="docutils literal notranslate"><span class="pre">fina</span></code>, <code class="docutils literal notranslate"><span class="pre">fin2</span></code>, or
<code class="docutils literal notranslate"><span class="pre">fin3</span></code> features.</p>
</section>
<section id="applying-the-stch-feature">
<h3>4. Applying the <code class="docutils literal notranslate"><span class="pre">stch</span></code> feature<a class="headerlink" href="#applying-the-stch-feature" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">stch</span></code> feature decomposes and stretches special marks that are
meant to extend to the full width of words to which they are
attached. It was defined for use in <code class="docutils literal notranslate"><span class="pre">&lt;syrc&gt;</span></code> text runs for the “Syriac
Abbreviation Mark” (<code class="docutils literal notranslate"><span class="pre">U+070F</span></code>) but it can be used with similar marks in
other scripts.</p>
<p>To apply the <code class="docutils literal notranslate"><span class="pre">stch</span></code> feature, the shaping engine should first decompose the
<code class="docutils literal notranslate"><span class="pre">U+070F</span></code> glyph into components, which results in a beginning point,
midpoint, and endpoint glyphs plus one (or more) extension glyphs: at
least one extension between the beginning and midpoint glyphs and at
least one extension between the midpoint and endpoint glyphs.</p>
<p>The shaping engine must then calculate the total length of the word to
which the mark applies. That length, minus the advance widths of the
beginning, middle, and endpoint glyphs of the mark, must be divided by
two.</p>
<p>The result, divided by the advance width of the extension glyph
and rounded up to the next integer, tells the shaping engine how many
copies of the extension glyph must be placed between the midpoint and
each end of the mark.</p>
<p>Following this procedure ensures that the same number of extensions is
used on each side of the mark so that it remains symmetrical.</p>
<p>Finally, the decomposed mark must be reordered as follows:</p>
<ul class="simple">
<li><p>All of the glyphs in the sequence for the mark, <em>except</em> for
the final glyph, are repositioned as a group so that they precede
the word to which the mark is attached.</p></li>
<li><p>The final glyph in the mark sequence is repositioned to the end of
the word.</p></li>
</ul>
</section>
<section id="applying-the-language-form-substitution-features-from-gsub">
<h3>5. Applying the language-form substitution features from GSUB<a class="headerlink" href="#applying-the-language-form-substitution-features-from-gsub" title="Permalink to this heading">¶</a></h3>
<p>The language-substitution phase applies mandatory substitution
features using the rules in the font’s GSUB table. In preparation for
this stage, glyph sequences should be tagged for possible application
of GSUB features.</p>
<p>The order in which these substitutions must be performed is fixed for
all scripts implemented with the Arabic shaping model:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>locl
isol
fina
fin2 (only used in Syriac)
fin3 (only used in Syriac)
medi
med2 (only used in Syriac)
init
rlig
rclt
calt
</pre></div>
</div>
<blockquote>
<div><p>Note: RLIG and CALT need to be appled to the word as a whole before
continuing to the next feature.</p>
</div></blockquote>
<p>See the individual script pages for further detail on each feature and
for script-specific information.</p>
<blockquote>
<div><p>Note: Strictly speaking, the use of localized-form substitutions is
not part of the shaping process, but of the localization process,
and could take place at an earlier point while handling the text
run. However, shaping engines are expected to complete the
application of the <code class="docutils literal notranslate"><span class="pre">locl</span></code> feature before applying the subsequent
GSUB substitutions in the following steps.</p>
</div></blockquote>
</section>
<section id="applying-the-typographic-form-substitution-features-from-gsub">
<h3>6. Applying the typographic-form substitution features from GSUB<a class="headerlink" href="#applying-the-typographic-form-substitution-features-from-gsub" title="Permalink to this heading">¶</a></h3>
<p>The typographic-substitution phase applies optional substitution
features using the rules in the font’s GSUB table.</p>
<p>The order in which these substitution must be performed is fixed for
all scripts implemented in the Arabic shaping model:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>liga
dlig
cswh
mset
</pre></div>
</div>
<p>See the individual script pages for further detail on each feature and
for script-specific information.</p>
</section>
<section id="applying-the-positioning-features-from-gpos">
<h3>7. Applying the positioning features from GPOS<a class="headerlink" href="#applying-the-positioning-features-from-gpos" title="Permalink to this heading">¶</a></h3>
<p>The positioning stage adjusts the positions of mark and base
glyphs.</p>
<p>The order in which these features are applied is fixed for
all scripts implemented in the Arabic shaping model:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>curs
kern
mark
mkmk
</pre></div>
</div>
<p>See the individual script pages for further detail on each feature and
for script-specific information.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">OpenType Shaping Documents</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=n8willis&repo=opentype-shaping-documents&type=watch&count=True&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="README.html">Scripts</a></li>
    
    <li class="toctree-l1"><a href="character-tables/character-tables-index.html">Character tables</a></li>
    
    <li class="toctree-l1"><a href="opentype-shaping-normalization.html">Normalization</a></li>
    
    <li class="toctree-l1"><a href="notes/README.html">Notes</a></li>
    
    <li class="toctree-l1"><a href="errata.html">Errata</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Sponsored by YesLogic.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/opentype-shaping-arabic-general.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>